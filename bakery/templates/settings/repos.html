{% extends "base.html" %}
{% set page_title = _("User repositories") %}

{% block body %}

<div class="span9">
    <h2>{{ _("Select repositories") }}</h2>

    <form class="well well-small" action="{{ url_for('settings.update') }}" method="POST">
        {% if cache %}
            Last update was {{ cache.updated | pretty_date}}
            {% else %}
            Never updated
        {% endif %}
        <button type="submit" class="btn btn-info btn-small pull-right">Refresh</button>
    </form>

<table class="table table-striped">
  <tbody>
    {% if cache %}
      {% for item in cache.data -%}
        <tr>
          <td>{% if item.full_name in projects %}<a href="{{ url_for('settings.delhook', full_name=item.full_name) }}"><i class="icon-star icon-white"></i></a>{% else %}<a href="{{ url_for('settings.addhook', full_name=item.full_name) }}"><i class="icon-star-empty"></i></a>{% endif %}</td>
          <td>{{ item.full_name }} {% if item.homepage %}<a href="{{ item.homepage}} "><i class="icon-share"></i></a>{% endif %}</td>
          <td>{% if item.description %}{{ item.description | truncate(length=80)}}{% endif %}</td>
          <td><a href="{{ item.html_url }}/settings/hooks"><i class="icon-wrench"></i></a></td>
        </tr>
      {%- endfor %}
    {% else %}
    <tr>
        <td colspan="4">
            <p class="muted">Refresh repositories list</p>
        </td>
    </tr> 
    {% endif %}
  </tbody>
</table>

</div>
{% endblock %}